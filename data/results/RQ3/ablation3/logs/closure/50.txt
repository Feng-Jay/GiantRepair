Repair : closure_50
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/0.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/0.java
Tested:0 patches
Compile failed:0 patches
Compilation rate:NaN

Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/1.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/1.java
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

Following are 0th generated patches:
Validating 106 patches...
Current actions:
INSERT:
83:Node newString=Node.newString(joinString);
TO:
82

Following are 1th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

INSERT:
83:Node newString=Node.newString(joinString);
TO:
82

INSERT:
84:Node joinedString=new Node(Token.ADD,arrayFoldedChildren.get(0),newString);
TO:
82

Following are 2th generated patches:
Validating 200 patches...
Tested:505 patches
Compile failed:483 patches
Compilation rate:0.04356435643564356
NNNNNNNNNNNNNNNNNNNPNNPPNNNNNPNNNNNPPPNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPNPNPNNNNNNNNNNNNNNNNPNNNNPNNPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/2.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/2.java
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

Following are 0th generated patches:
Validating 63 patches...
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

UPDATE
FROM:
59:return emptyStringNode;
TO:
55:return Node.newString("");

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

INSERT:
57:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
60

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

Following are 1th generated patches:
Validating 5 patches...
Current actions:
DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

Following are 2th generated patches:
Validating 1 patches...
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

UPDATE
FROM:
59:return emptyStringNode;
TO:
55:return Node.newString("");

INSERT:
57:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
60

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

Following are 3th generated patches:
Validating 4 patches...
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

UPDATE
FROM:
59:return emptyStringNode;
TO:
55:return Node.newString("");

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

INSERT:
58:if(foldedSize>originalSize){
return n;
}
TO:
60

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

Following are 4th generated patches:
Validating 6 patches...
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

UPDATE
FROM:
59:return emptyStringNode;
TO:
55:return Node.newString("");

INSERT:
57:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
60

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

Tested:535 patches
Compile failed:494 patches
Compilation rate:0.07663551401869159
NNNNNNNPPPPPPPNPPNNPPPPPPPNPPP
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/3.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/3.java
Current actions:
UPDATE
FROM:
18:String joinString=(right==null)?",":NodeUtil.getStringValue(right);
TO:
18:String joinString=right==null?",":NodeUtil.getStringValue(right);

Following are 0th generated patches:
Validating 1 patches...
Current actions:
UPDATE
FROM:
18:String joinString=(right==null)?",":NodeUtil.getStringValue(right);
TO:
18:String joinString=right==null?",":NodeUtil.getStringValue(right);

Following are 1th generated patches:
Validating 200 patches...
Tested:736 patches
Compile failed:686 patches
Compilation rate:0.06793478260869565
PNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNPNNNNNNPNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/4.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/4.java
Current actions:
INSERT:
24:if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
arrayFoldedChildren.add(elem);
}
TO:
24

DELETE:
Original line: 25if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}

DELETE:
Original line: 42arrayFoldedChildren.add(elem);

Following are 1th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 38arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));

Following are 4th generated patches:
Validating 1 patches...
Current actions:
INSERT:
29:Node joinedNode=NodeUtil.joinStringNodes(prev,elem,joinString);
TO:
29

INSERT:
41:if(prev!=null&&prev.getType()==Token.STRING){
Node joinedNode=NodeUtil.joinStringNodes(prev,null,joinString);
foldedSize+=InlineCostEstimator.getCost(joinedNode);
arrayFoldedChildren.add(joinedNode);
}
TO:
46

Tested:937 patches
Compile failed:871 patches
Compilation rate:0.07043756670224119
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPPPNNPNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPNNNNNNNNNNNNNNNNNNNNPNNPNNNNPNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNPPPN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/5.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/5.java
Current actions:
INSERT:
24:if(prev!=null&&prev.getType()==Token.STRING){
Node folded=Node.newString(prev.getString()+joinString+NodeUtil.getArrayElementStringValue(elem));
arrayFoldedChildren.add(folded);
prev=folded;
elem=elem.getNext();
continue;
}
TO:
25

Following are 1th generated patches:
Validating 1 patches...
Current actions:
INSERT:
31:}

TO:
28

INSERT:
32:if(prev==null){
prev=elem;
}
TO:
28

DELETE:
Original line: 44prev=elem;

Following are 2th generated patches:
Validating 38 patches...
Current actions:
INSERT:
42:if(prev!=null){
foldedSize+=InlineCostEstimator.getCost(prev);
arrayFoldedChildren.add(prev);
}
TO:
46

Following are 3th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 21int foldedSize=0;

INSERT:
24:if(prev!=null&&prev.getType()==Token.STRING){
Node folded=Node.newString(prev.getString()+joinString+NodeUtil.getArrayElementStringValue(elem));
arrayFoldedChildren.add(folded);
prev=folded;
elem=elem.getNext();
continue;
}
TO:
25

DELETE:
Original line: 26if(sb==null){
sb=new StringBuilder();
}

DELETE:
Original line: 29else{
sb.append(joinString);
}

INSERT:
31:}

TO:
28

DELETE:
Original line: 32sb.append(NodeUtil.getArrayElementStringValue(elem));

UPDATE
FROM:
41:foldedSize+=InlineCostEstimator.getCost(elem);
TO:
36:foldedSize+=InlineCostEstimator.getCost(prev);

DELETE:
Original line: 36Preconditions.checkNotNull(prev);

DELETE:
Original line: 37foldedSize+=sb.length()+2;

DELETE:
Original line: 38arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));

DELETE:
Original line: 39sb=null;

INSERT:
42:if(prev!=null){
foldedSize+=InlineCostEstimator.getCost(prev);
arrayFoldedChildren.add(prev);
}
TO:
46

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

Following are 4th generated patches:
Validating 200 patches...
Tested:1371 patches
Compile failed:1276 patches
Compilation rate:0.06929248723559446
PNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNPPNPNNPPNNNNNNNNNNPNNNNNNNNNNNNNNNPNNNNNNNNNPNPNNNNNNNNNNNPNNNPNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPNNPPPNPPPNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNPNNNPNPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/6.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/6.java
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

Following are 0th generated patches:
Validating 3 patches...
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

INSERT:
52:foldedSize+=(arrayFoldedChildren.size()-1)*(joinString.length()+2);
TO:
51

Following are 1th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

Following are 2th generated patches:
Validating 1 patches...
Current actions:
INSERT:
52:foldedSize+=(arrayFoldedChildren.size()-1)*(joinString.length()+2);
TO:
51

Following are 3th generated patches:
Validating 200 patches...
Tested:1774 patches
Compile failed:1657 patches
Compilation rate:0.06595264937993235
PPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNPNNNNNNNNNNNPNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNPNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNPNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNPNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNP
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/7.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/7.java
Current actions:
INSERT:
48:if(arrayFoldedChildren.size()>1){
arrayNode.detachChildren();
for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
}
TO:
51

INSERT:
56:}

TO:
51

DELETE:
Original line: 65arrayNode.detachChildren();

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

Following are 1th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 21int foldedSize=0;

DELETE:
Original line: 37foldedSize+=sb.length()+2;

DELETE:
Original line: 41foldedSize+=InlineCostEstimator.getCost(elem);

INSERT:
48:if(arrayFoldedChildren.size()>1){
arrayNode.detachChildren();
for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
}
TO:
51

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

DELETE:
Original line: 53int originalSize=InlineCostEstimator.getCost(n);

INSERT:
54:reportCodeChange();
TO:
51

INSERT:
55:return n;
TO:
51

DELETE:
Original line: 55case 0 :

INSERT:
56:}

TO:
51

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 59return emptyStringNode;

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

DELETE:
Original line: 65arrayNode.detachChildren();

DELETE:
Original line: 67Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);

DELETE:
Original line: 68foldedStringNode=replacement;

DELETE:
Original line: 70n.getParent().replaceChild(n,foldedStringNode);

DELETE:
Original line: 71reportCodeChange();

DELETE:
Original line: 72return foldedStringNode;

DELETE:
Original line: 73default :

DELETE:
Original line: 74if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}

DELETE:
Original line: 77int kJoinOverhead="[].join()".length();

DELETE:
Original line: 78foldedSize+=kJoinOverhead;

DELETE:
Original line: 79foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;

DELETE:
Original line: 81return n;

DELETE:
Original line: 83arrayNode.detachChildren();

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

DELETE:
Original line: 87reportCodeChange();

DELETE:
Original line: 90return n;

Following are 2th generated patches:
Validating 200 patches...
Tested:2171 patches
Compile failed:2054 patches
Compilation rate:0.05389221556886228
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/8.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/8.java
Current actions:
DELETE:
Original line: 74if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}

Following are 0th generated patches:
Validating 11 patches...
Current actions:
DELETE:
Original line: 74if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}

DELETE:
Original line: 77int kJoinOverhead="[].join()".length();

DELETE:
Original line: 78foldedSize+=kJoinOverhead;

Following are 1th generated patches:
Validating 3 patches...
Current actions:
DELETE:
Original line: 77int kJoinOverhead="[].join()".length();

DELETE:
Original line: 78foldedSize+=kJoinOverhead;

Following are 2th generated patches:
Validating 2 patches...
Current actions:
DELETE:
Original line: 74if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}

DELETE:
Original line: 78foldedSize+=kJoinOverhead;

Following are 3th generated patches:
Validating 2 patches...
Current actions:
DELETE:
Original line: 75return n;

DELETE:
Original line: 77int kJoinOverhead="[].join()".length();

Following are 4th generated patches:
Validating 2 patches...
Current actions:
DELETE:
Original line: 77int kJoinOverhead="[].join()".length();

Tested:2186 patches
Compile failed:2058 patches
Compilation rate:0.0585544373284538
NNNPPPPPPPPPPPN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/9.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/9.java
Tested:2186 patches
Compile failed:2058 patches
Compilation rate:0.0585544373284538

Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/10.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/10.java
Current actions:
INSERT:
27:if(prev!=null){
foldedSize+=InlineCostEstimator.getCost(prev);
}
TO:
34

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
36:if(prev!=null){
foldedSize+=InlineCostEstimator.getCost(prev);
}
TO:
46

Following are 2th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

DELETE:
Original line: 20StringBuilder sb=null;

INSERT:
24:foldedSize+=InlineCostEstimator.getCost(elem);
TO:
25

DELETE:
Original line: 26if(sb==null){
sb=new StringBuilder();
}

INSERT:
27:if(prev!=null){
foldedSize+=InlineCostEstimator.getCost(prev);
}
TO:
34

DELETE:
Original line: 29else{
sb.append(joinString);
}

INSERT:
31:foldedSize+=joinString.length();
TO:
41

DELETE:
Original line: 35if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}

INSERT:
37:foldedSize+=InlineCostEstimator.getCost(prev);
TO:
46

UPDATE
FROM:
52:foldedSize+=arrayFoldedChildren.size()-1;
TO:
40:foldedSize+=arrayNode.getChildCount()-1;

DELETE:
Original line: 42arrayFoldedChildren.add(elem);

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

UPDATE
FROM:
61:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
48:Node foldedStringNode=arrayNode.getFirstChild();

UPDATE
FROM:
74:if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}
TO:
61:if(arrayNode.getChildCount()==arrayNode.getChildCount()){
return n;
}

INSERT:
66:if(right!=null){
foldedSize+=InlineCostEstimator.getCost(right);
}
TO:
78

UPDATE
FROM:
84:for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
TO:
73:for(Node node : arrayNode.children()){
arrayNode.addChildToBack(node);
}

DELETE:
Original line: 79foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;

Tested:2586 patches
Compile failed:2420 patches
Compilation rate:0.06419180201082754
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNPNPNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNPNPNPPNPPPNNNNNPPNNNNNNNNNPNNNNNNNNNPNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNPNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNPNNNPPNPNPPPNNPNNNNPPNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNPP
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/11.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/11.java
Current actions:
Wrap:
IfStatement
On:
[return n;]
Following are 0th generated patches:
Validating 14 patches...
Current actions:
INSERT:
52:if(arrayFoldedChildren.size()!=arrayNode.getChildCount()){
return n;
}
TO:
51

DELETE:
Original line: 75return n;

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
52:if(arrayFoldedChildren.size()!=arrayNode.getChildCount()){
return n;
}
TO:
51

DELETE:
Original line: 75return n;

DELETE:
Original line: 77int kJoinOverhead="[].join()".length();

Following are 2th generated patches:
Validating 200 patches...
Tested:2994 patches
Compile failed:2812 patches
Compilation rate:0.06078824315297261
NNPPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNPNNNNNNNNPNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/12.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/12.java
Current actions:
INSERT:
29:if(prev!=null){
foldedSize+=joinString.length();
foldedSize+=InlineCostEstimator.getCost(prev);
}
TO:
34

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
39:if(prev!=null){
foldedSize+=joinString.length();
foldedSize+=InlineCostEstimator.getCost(prev);
}
TO:
46

Following are 2th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 20StringBuilder sb=null;

INSERT:
25:foldedSize+=InlineCostEstimator.getCost(elem);
TO:
25

DELETE:
Original line: 26if(sb==null){
sb=new StringBuilder();
}

DELETE:
Original line: 29else{
sb.append(joinString);
}

UPDATE
FROM:
37:foldedSize+=sb.length()+2;
TO:
30:foldedSize+=joinString.length();

INSERT:
31:foldedSize+=InlineCostEstimator.getCost(prev);
TO:
37

DELETE:
Original line: 32sb.append(NodeUtil.getArrayElementStringValue(elem));

DELETE:
Original line: 35if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}

INSERT:
39:if(prev!=null){
foldedSize+=joinString.length();
foldedSize+=InlineCostEstimator.getCost(prev);
}
TO:
46

UPDATE
FROM:
49:foldedSize+=sb.length()+2;
TO:
40:foldedSize+=joinString.length();

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

Following are 3th generated patches:
Validating 200 patches...
Tested:3590 patches
Compile failed:3390 patches
Compilation rate:0.055710306406685235
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/13.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/13.java
Current actions:
Wrap:
MethodDeclaration
On:
[List<Node> arrayFoldedChildren=Lists.newLinkedList();, return n;, String joinString=(right==null)?",":NodeUtil.getStringValue(right);, StringBuilder sb=null;, int foldedSize=0;, Node elem=arrayNode.getFirstChild();, while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}
else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}
prev=elem;
elem=elem.getNext();
}, {
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}
else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}
prev=elem;
elem=elem.getNext();
}, if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}, {
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}, else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}, else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}, {
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}, {
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}, if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}, if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}, {
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}, {
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}, foldedSize+=sb.length()+2;, foldedSize+=sb.length()+2;, sb=null;, sb=null;, foldedSize+=InlineCostEstimator.getCost(elem);, foldedSize+=InlineCostEstimator.getCost(elem);, arrayFoldedChildren.add(elem);, arrayFoldedChildren.add(elem);, elem=elem.getNext();, if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}, {
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}, foldedSize+=sb.length()+2;, foldedSize+=arrayFoldedChildren.size()-1;, int originalSize=InlineCostEstimator.getCost(n);]
Following are 0th generated patches:
Validating 63 patches...
Current actions:
DELETE:
Original line: 48Preconditions.checkNotNull(prev);

Following are 1th generated patches:
Validating 1 patches...
Current actions:
INSERT:
2:private Node tryFoldArrayJoin(Node n){
Node callTarget=n.getFirstChild();
if(callTarget==null||!NodeUtil.isGetProp(callTarget)){
return n;
}
Node right=callTarget.getNext();
if(right!=null){
if(!NodeUtil.isImmutableValue(right)){
return n;
}
}
Node arrayNode=callTarget.getFirstChild();
Node functionName=arrayNode.getNext();
if((arrayNode.getType()!=Token.ARRAYLIT)||!functionName.getString().equals("join")){
return n;
}
String joinString=(right==null)?",":NodeUtil.getStringValue(right);
StringBuilder sb=null;
int foldedSize=0;
List<Node> arrayFoldedChildren=Lists.newLinkedList();
Node elem=arrayNode.getFirstChild();
while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}
else{
if(sb!=null){
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(elem));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}
elem=elem.getNext();
}
if(sb!=null){
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(elem));
}
foldedSize+=arrayFoldedChildren.size()-1;
int originalSize=InlineCostEstimator.getCost(n);
switch (arrayFoldedChildren.size()){
case 0 :
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
case 1 :
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
default :
if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}
int kJoinOverhead="[].join()".length();
foldedSize+=kJoinOverhead;
foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
reportCodeChange();
break;
}
return n;
}
TO:
1

DELETE:
Original line: 16return n;

DELETE:
Original line: 18String joinString=(right==null)?",":NodeUtil.getStringValue(right);

DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

DELETE:
Original line: 20StringBuilder sb=null;

DELETE:
Original line: 21int foldedSize=0;

DELETE:
Original line: 22Node prev=null;

DELETE:
Original line: 23Node elem=arrayNode.getFirstChild();

DELETE:
Original line: 24while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}
else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}
prev=elem;
elem=elem.getNext();
}

UPDATE
FROM:
38:arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
TO:
36:arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(elem));

UPDATE
FROM:
50:arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
TO:
46:arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(elem));

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

DELETE:
Original line: 53int originalSize=InlineCostEstimator.getCost(n);

Following are 2th generated patches:
Validating 200 patches...
Tested:3830 patches
Compile failed:3603 patches
Compilation rate:0.05926892950391645
NNNNNNPPPPPPPPPPNNNNNNNNNNPPPPPPPPPPPPPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/14.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/14.java
Current actions:
UPDATE
FROM:
18:String joinString=(right==null)?",":NodeUtil.getStringValue(right);
TO:
18:String joinString=(right==null)?",":right.getString();

Following are 0th generated patches:
Validating 1 patches...
Current actions:
UPDATE
FROM:
18:String joinString=(right==null)?",":NodeUtil.getStringValue(right);
TO:
18:String joinString=(right==null)?",":right.getString();

Following are 1th generated patches:
Validating 200 patches...
Tested:4031 patches
Compile failed:3791 patches
Compilation rate:0.05953857603572314
PNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNPNNPNNNPNNNNNPNNNNNNNNNNNNNNNNNNNNPPPPP
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/15.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/15.java
Current actions:
DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

Following are 0th generated patches:
Validating 41 patches...
Current actions:
UPDATE
FROM:
59:return emptyStringNode;
TO:
56:return Node.newString("");

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

INSERT:
58:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
60

INSERT:
59:if(foldedSize>originalSize){
return n;
}
TO:
60

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

Following are 1th generated patches:
Validating 5 patches...
Current actions:
DELETE:
Original line: 58reportCodeChange();

Following are 2th generated patches:
Validating 1 patches...
Current actions:
UPDATE
FROM:
59:return emptyStringNode;
TO:
56:return Node.newString("");

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

INSERT:
58:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
60

DELETE:
Original line: 58reportCodeChange();

INSERT:
59:if(foldedSize>originalSize){
return n;
}
TO:
60

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

Following are 3th generated patches:
Validating 6 patches...
Current actions:
UPDATE
FROM:
59:return emptyStringNode;
TO:
56:return Node.newString("");

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

INSERT:
58:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
60

INSERT:
59:if(foldedSize>originalSize){
return n;
}
TO:
60

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

Following are 4th generated patches:
Validating 4 patches...
Current actions:
DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

INSERT:
59:if(foldedSize>originalSize){
return n;
}
TO:
60

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

Tested:4050 patches
Compile failed:3798 patches
Compilation rate:0.06222222222222222
NNNNNNPPPPPPPPPPPPN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/16.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/16.java
Current actions:
INSERT:
18:if(right==null){
right=new Node(Token.STRING,",");
}
TO:
17

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
23:if(foldedStringNode==emptyStringNode){
return n;
}
TO:
17

INSERT:
35:}

TO:
17

INSERT:
63:}

TO:
46

DELETE:
Original line: 63return n;

INSERT:
70:}

TO:
46

INSERT:
72:}

TO:
46

INSERT:
78:}

TO:
51

Following are 2th generated patches:
Validating 62 patches...
Current actions:
INSERT:
26:if(foldedStringNode==arrayNode){
return n;
}
TO:
17

INSERT:
35:}

TO:
17

INSERT:
63:}

TO:
46

INSERT:
70:}

TO:
46

INSERT:
72:}

TO:
46

DELETE:
Original line: 75return n;

INSERT:
78:}

TO:
51

Following are 3th generated patches:
Validating 62 patches...
Current actions:
INSERT:
29:if(foldedStringNode!=null){
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
}
TO:
17

INSERT:
35:}

TO:
17

DELETE:
Original line: 58reportCodeChange();

INSERT:
63:}

TO:
46

DELETE:
Original line: 70n.getParent().replaceChild(n,foldedStringNode);

INSERT:
70:}

TO:
46

DELETE:
Original line: 72return foldedStringNode;

INSERT:
72:}

TO:
46

INSERT:
78:}

TO:
51

Following are 4th generated patches:
Validating 32 patches...
Current actions:
INSERT:
18:if(right==null){
right=new Node(Token.STRING,",");
}
TO:
17

DELETE:
Original line: 18String joinString=(right==null)?",":NodeUtil.getStringValue(right);

DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

DELETE:
Original line: 20StringBuilder sb=null;

DELETE:
Original line: 21int foldedSize=0;

INSERT:
26:if(foldedStringNode==arrayNode){
return n;
}
TO:
17

DELETE:
Original line: 32sb.append(NodeUtil.getArrayElementStringValue(elem));

INSERT:
34:return n;
TO:
17

INSERT:
35:}

TO:
17

DELETE:
Original line: 39sb=null;

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

DELETE:
Original line: 55case 0 :

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 60case 1 :

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

INSERT:
63:}

TO:
46

DELETE:
Original line: 67Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);

DELETE:
Original line: 68foldedStringNode=replacement;

INSERT:
70:}

TO:
46

INSERT:
72:}

TO:
46

DELETE:
Original line: 74if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}

INSERT:
78:}

TO:
51

DELETE:
Original line: 80if(foldedSize>originalSize){
return n;
}

DELETE:
Original line: 88break;

DELETE:
Original line: 90return n;

Tested:4406 patches
Compile failed:4138 patches
Compilation rate:0.06082614616432138
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNPPNNNNPNNNNNNNNNNNNNNNNNNPNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNPPNPNNNNNNNNNNNNNNNNNNNNNNNNNNPNNPNNNNNNNNNNNNNNNNNPNNNNNNNNPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/17.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/17.java
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

Following are 0th generated patches:
Validating 36 patches...
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

INSERT:
83:Node newArrayNode=Node.newArray(arrayFoldedChildren).copyInformationFrom(arrayNode);
TO:
82

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

INSERT:
84:newArrayNode.useSourceInfoIfMissingFromForTree(n);
TO:
82

INSERT:
85:n.getParent().replaceChild(n,newArrayNode);
TO:
82

Following are 1th generated patches:
Validating 200 patches...
Tested:4638 patches
Compile failed:4364 patches
Compilation rate:0.05907718844329452
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNP
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/18.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/18.java
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

Following are 0th generated patches:
Validating 21 patches...
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

Following are 1th generated patches:
Validating 2 patches...
Current actions:
DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

Following are 2th generated patches:
Validating 1 patches...
Current actions:
INSERT:
83:Node newArrayNode=new Node(Token.ARRAYLIT,arrayFoldedChildren);
TO:
82

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

INSERT:
84:n.getParent().replaceChild(n,newArrayNode);
TO:
82

Following are 3th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

INSERT:
83:Node newArrayNode=new Node(Token.ARRAYLIT,arrayFoldedChildren);
TO:
82

Following are 4th generated patches:
Validating 12 patches...
Current actions:
INSERT:
83:Node newArrayNode=new Node(Token.ARRAYLIT,arrayFoldedChildren);
TO:
82

Tested:4870 patches
Compile failed:4589 patches
Compilation rate:0.057700205338809034
NNNNNNNNNNNNNNNNPPPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/19.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/19.java
Current actions:
INSERT:
52:if(arrayFoldedChildren.size()==0){
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
}
TO:
51

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 59return emptyStringNode;

INSERT:
71:}

TO:
56

Following are 1th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 53int originalSize=InlineCostEstimator.getCost(n);

DELETE:
Original line: 54switch (arrayFoldedChildren.size()){
case 0 :
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
case 1 :
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
default :
if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}
int kJoinOverhead="[].join()".length();
foldedSize+=kJoinOverhead;
foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
reportCodeChange();
break;
}

INSERT:
58:int originalSize=InlineCostEstimator.getCost(n);
TO:
56

INSERT:
60:foldedSize+=kJoinOverhead;
TO:
56

INSERT:
61:foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
TO:
56

INSERT:
62:if(foldedSize>originalSize){
return n;
}
TO:
56

INSERT:
65:arrayNode.detachChildren();
TO:
56

INSERT:
66:for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
TO:
56

INSERT:
69:reportCodeChange();
TO:
56

INSERT:
70:return n;
TO:
56

INSERT:
71:}

TO:
56

DELETE:
Original line: 90return n;

Following are 2th generated patches:
Validating 9 patches...
Current actions:
DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

INSERT:
52:if(arrayFoldedChildren.size()==0){
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
}
TO:
51

DELETE:
Original line: 53int originalSize=InlineCostEstimator.getCost(n);

DELETE:
Original line: 54switch (arrayFoldedChildren.size()){
case 0 :
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
case 1 :
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
default :
if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}
int kJoinOverhead="[].join()".length();
foldedSize+=kJoinOverhead;
foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
reportCodeChange();
break;
}

INSERT:
58:int originalSize=InlineCostEstimator.getCost(n);
TO:
56

INSERT:
59:int kJoinOverhead="[].join()".length();
TO:
56

INSERT:
60:foldedSize+=kJoinOverhead;
TO:
56

INSERT:
61:foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
TO:
56

INSERT:
62:if(foldedSize>originalSize){
return n;
}
TO:
56

INSERT:
66:for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
TO:
56

INSERT:
69:reportCodeChange();
TO:
56

INSERT:
70:return n;
TO:
56

INSERT:
71:}

TO:
56

DELETE:
Original line: 90return n;

Following are 3th generated patches:
Validating 200 patches...
Tested:5270 patches
Compile failed:4989 patches
Compilation rate:0.05332068311195446
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/20.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/20.java
Current actions:
DELETE:
Original line: 65arrayNode.detachChildren();

Following are 0th generated patches:
Validating 1 patches...
Current actions:
DELETE:
Original line: 65arrayNode.detachChildren();

Following are 0th generated patches:
Validating 1 patches...
Tested:5272 patches
Compile failed:4989 patches
Compilation rate:0.05367981790591806
PP
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/21.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/21.java
Tested:5272 patches
Compile failed:4989 patches
Compilation rate:0.05367981790591806

Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/22.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/22.java
Current actions:
INSERT:
28:if(prev!=null){
arrayFoldedChildren.add(Node.newString(joinString).copyInformationFrom(prev));
}
TO:
34

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
36:if(prev!=null){
arrayFoldedChildren.add(Node.newString(joinString).copyInformationFrom(prev));
}
TO:
46

Following are 2th generated patches:
Validating 200 patches...
Current actions:
UPDATE
FROM:
18:String joinString=(right==null)?",":NodeUtil.getStringValue(right);
TO:
18:String joinString=(right==null)?",":right.getString();

UPDATE
FROM:
19:List<Node> arrayFoldedChildren=Lists.newLinkedList();
TO:
19:List<Node> arrayFoldedChildren=new ArrayList<Node>();

INSERT:
20:int originalSize=InlineCostEstimator.getCost(n);
TO:
19

DELETE:
Original line: 20StringBuilder sb=null;

DELETE:
Original line: 21int foldedSize=0;

INSERT:
25:arrayFoldedChildren.add(Node.newString(elem.getString()).copyInformationFrom(elem));
TO:
25

DELETE:
Original line: 27sb=new StringBuilder();

INSERT:
28:if(prev!=null){
arrayFoldedChildren.add(Node.newString(joinString).copyInformationFrom(prev));
}
TO:
34

UPDATE
FROM:
38:arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
TO:
29:arrayFoldedChildren.add(Node.newString(joinString).copyInformationFrom(prev));

DELETE:
Original line: 29else{
sb.append(joinString);
}

DELETE:
Original line: 32sb.append(NodeUtil.getArrayElementStringValue(elem));

DELETE:
Original line: 36Preconditions.checkNotNull(prev);

INSERT:
36:if(prev!=null){
arrayFoldedChildren.add(Node.newString(joinString).copyInformationFrom(prev));
}
TO:
46

UPDATE
FROM:
50:arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
TO:
37:arrayFoldedChildren.add(Node.newString(joinString).copyInformationFrom(prev));

DELETE:
Original line: 37foldedSize+=sb.length()+2;

DELETE:
Original line: 39sb=null;

INSERT:
39:int foldedSize=arrayFoldedChildren.size();
TO:
51

INSERT:
40:if(foldedSize==0){
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
}
TO:
51

DELETE:
Original line: 41foldedSize+=InlineCostEstimator.getCost(elem);

INSERT:
46:if(foldedSize==1){
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
}
TO:
56

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

DELETE:
Original line: 53int originalSize=InlineCostEstimator.getCost(n);

DELETE:
Original line: 54switch (arrayFoldedChildren.size()){
case 0 :
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
case 1 :
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
default :
if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}
int kJoinOverhead="[].join()".length();
foldedSize+=kJoinOverhead;
foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
reportCodeChange();
break;
}

INSERT:
76:return n;
TO:
56

INSERT:
77:}

TO:
56

DELETE:
Original line: 90return n;

Tested:5672 patches
Compile failed:5308 patches
Compilation rate:0.06417489421720733
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNPNNNNNNNNNNNNPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPPPNNPPPNPNPNNPPNNNPPNNNNPPPPNNNNPNNNPNNNPPPPNNPNPPNNPNPNNNNPNNNNPNNNNPNNNNPNNPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPNNPNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNPNPPPPPNPPNNPNNNNNPNPPPNPNPNNPNPNNNNNNNPPNPPPNPNNNNNPPNPNNPNNPNNNNNPPNNNNNPNNPPPP
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/23.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/23.java
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

Following are 0th generated patches:
Validating 41 patches...
Current actions:
INSERT:
85:joinNode.addChildToBack(Node.newString("]").copyInformationFrom(callTarget));
TO:
82

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
83:Node joinNode=Node.newString("");
TO:
82

DELETE:
Original line: 83arrayNode.detachChildren();

INSERT:
84:joinNode.addChildToFront(Node.newString("[").copyInformationFrom(callTarget));
TO:
82

INSERT:
85:joinNode.addChildToBack(Node.newString("]").copyInformationFrom(callTarget));
TO:
82

INSERT:
86:n.getParent().replaceChild(n,joinNode);
TO:
82

UPDATE
FROM:
85:arrayNode.addChildToBack(node);
TO:
88:joinNode.addChildToBack(node);

Following are 2th generated patches:
Validating 200 patches...
Tested:6113 patches
Compile failed:5729 patches
Compilation rate:0.06281694748895796
NNNNNNNNPPPPPPNNNNNNNPPPPNNNNNNNNNPPPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/24.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/24.java
Current actions:
INSERT:
49:if(arrayFoldedChildren.size()==0){
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
}
TO:
51

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 59return emptyStringNode;

INSERT:
81:}

TO:
56

Following are 1th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 37foldedSize+=sb.length()+2;

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

INSERT:
56:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
56

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

INSERT:
65:Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
TO:
56

DELETE:
Original line: 65arrayNode.detachChildren();

DELETE:
Original line: 67Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);

INSERT:
74:if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}
TO:
56

DELETE:
Original line: 74if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}

INSERT:
81:}

TO:
56

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

Tested:6313 patches
Compile failed:5929 patches
Compilation rate:0.06082686519879613
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/25.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/25.java
Current actions:
INSERT:
53:if(arrayFoldedChildren.size()==0){
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
}
TO:
51

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 59return emptyStringNode;

INSERT:
86:}

TO:
56

Following are 1th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

INSERT:
20:List<Node> arrayFoldedChildren=Lists.newLinkedList();
TO:
20

DELETE:
Original line: 55case 0 :

INSERT:
59:else{
if(arrayFoldedChildren.size()==1){
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>InlineCostEstimator.getCost(n)){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
}
}
TO:
56

DELETE:
Original line: 63return n;

DELETE:
Original line: 71reportCodeChange();

DELETE:
Original line: 72return foldedStringNode;

INSERT:
77:if(foldedSize>InlineCostEstimator.getCost(n)){
return n;
}
TO:
56

DELETE:
Original line: 81return n;

INSERT:
85:return n;
TO:
56

INSERT:
86:}

TO:
56

DELETE:
Original line: 90return n;

Following are 4th generated patches:
Validating 200 patches...
Tested:6711 patches
Compile failed:6327 patches
Compilation rate:0.057219490388913725
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/26.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/26.java
Current actions:
INSERT:
19:if(NodeUtil.getArrayLength(arrayNode)==0){
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
}
TO:
18

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
28:if(NodeUtil.getArrayElementStringValue(elem)==null){
oneString=false;
break;
}
TO:
18

Following are 2th generated patches:
Validating 200 patches...
Current actions:
INSERT:
20:Node emptyStringNode=Node.newString("");
TO:
18

INSERT:
21:n.getParent().replaceChild(n,emptyStringNode);
TO:
18

INSERT:
23:return emptyStringNode;
TO:
18

INSERT:
28:if(NodeUtil.getArrayElementStringValue(elem)==null){
oneString=false;
break;
}
TO:
18

INSERT:
34:if(oneString){
Node foldedStringNode=Node.newString("");
int index=0;
elem=arrayNode.getFirstChild();
while(elem!=null){
foldedStringNode=Node.newString(foldedStringNode.getString()+NodeUtil.getArrayElementStringValue(elem)+((index==NodeUtil.getArrayLength(arrayNode)-1)?"":joinString));
index++;
elem=elem.getNext();
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
}
TO:
18

INSERT:
47:int originalSize=InlineCostEstimator.getCost(n);
TO:
18

DELETE:
Original line: 53int originalSize=InlineCostEstimator.getCost(n);

Following are 4th generated patches:
Validating 200 patches...
Tested:7308 patches
Compile failed:6924 patches
Compilation rate:0.052545155993431854
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/27.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/27.java
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

Following are 0th generated patches:
Validating 41 patches...
Current actions:
DELETE:
Original line: 83arrayNode.detachChildren();

INSERT:
83:Node result=Node.newString("[");
TO:
82

INSERT:
86:result.addChildToBack(Node.newString(joinString));
TO:
85

INSERT:
89:result.getParent().replaceChild(n,result);
TO:
86

Following are 1th generated patches:
Validating 200 patches...
Tested:7547 patches
Compile failed:7143 patches
Compilation rate:0.053531204452100176
NNNNNNNNPPNPPPNPNNNNPNPPNNNPNNNNNNPPPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/28.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/28.java
Current actions:
INSERT:
29:if(right!=null){
foldedSize-=InlineCostEstimator.getCost(right);
}
TO:
46

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
54:if(node.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),node);
node=replacement;
}
TO:
83

Following are 2th generated patches:
Validating 12 patches...
Current actions:
DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

INSERT:
20:int foldedSize=kJoinOverhead;
TO:
18

DELETE:
Original line: 20StringBuilder sb=null;

DELETE:
Original line: 21int foldedSize=0;

INSERT:
24:foldedSize+=InlineCostEstimator.getCost(elem);
TO:
24

DELETE:
Original line: 26if(sb==null){
sb=new StringBuilder();
}

INSERT:
28:foldedSize-=InlineCostEstimator.getCost(arrayNode);
TO:
46

INSERT:
30:foldedSize-=InlineCostEstimator.getCost(right);
TO:
46

DELETE:
Original line: 30sb.append(joinString);

DELETE:
Original line: 34else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}

UPDATE
FROM:
61:Node foldedStringNode=arrayFoldedChildren.remove(0);
TO:
39:Node foldedStringNode=arrayNode.getFirstChild();

DELETE:
Original line: 48Preconditions.checkNotNull(prev);

DELETE:
Original line: 49foldedSize+=sb.length()+2;

INSERT:
55:Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),node);
TO:
83

INSERT:
56:node=replacement;
TO:
83

DELETE:
Original line: 63return n;

DELETE:
Original line: 65arrayNode.detachChildren();

DELETE:
Original line: 74if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}

DELETE:
Original line: 78foldedSize+=kJoinOverhead;

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

Following are 3th generated patches:
Validating 200 patches...
Tested:7949 patches
Compile failed:7528 patches
Compilation rate:0.052962636809661595
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNPNNNPNNNNNNNNNNNNNNNNNNNNPNPNNNNNNNNNNNNNNNNNNPNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPPNPPNPNNPNNNNNNNPNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/29.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/29.java
Current actions:
INSERT:
52:if(arrayFoldedChildren.isEmpty()){
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
}
TO:
51

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 59return emptyStringNode;

INSERT:
86:}

TO:
53

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
52:if(arrayFoldedChildren.isEmpty()){
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
}
TO:
51

DELETE:
Original line: 54switch (arrayFoldedChildren.size()){
case 0 :
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
case 1 :
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
default :
if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}
int kJoinOverhead="[].join()".length();
foldedSize+=kJoinOverhead;
foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
reportCodeChange();
break;
}

INSERT:
58:if(arrayFoldedChildren.size()==1){
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>InlineCostEstimator.getCost(n)){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
}
TO:
51

INSERT:
76:foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
TO:
53

INSERT:
77:if(foldedSize>originalSize){
return n;
}
TO:
53

INSERT:
80:arrayNode.detachChildren();
TO:
53

INSERT:
81:for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
TO:
53

INSERT:
84:reportCodeChange();
TO:
53

INSERT:
85:return n;
TO:
53

INSERT:
86:}

TO:
53

DELETE:
Original line: 90return n;

Following are 4th generated patches:
Validating 200 patches...
Tested:8349 patches
Compile failed:7928 patches
Compilation rate:0.05042520062282908
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/30.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/30.java
Current actions:
DELETE:
Original line: 21int foldedSize=0;

Following are 0th generated patches:
Validating 200 patches...
Current actions:
DELETE:
Original line: 21int foldedSize=0;

DELETE:
Original line: 37foldedSize+=sb.length()+2;

INSERT:
37:sb.append(NodeUtil.getArrayElementStringValue(elem));
TO:
36

UPDATE
FROM:
38:arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
TO:
38:arrayFoldedChildren.add(Node.newString(sb.toString()));

INSERT:
48:sb.append(joinString);
TO:
48

DELETE:
Original line: 63return n;

DELETE:
Original line: 65arrayNode.detachChildren();

INSERT:
73:int foldedSize=kJoinOverhead;
TO:
77

Following are 1th generated patches:
Validating 200 patches...
Tested:8746 patches
Compile failed:8221 patches
Compilation rate:0.06002744111593872
NNPPPPPPPPPPNPPPNPPPPPPPNNPPPPPNPNPNNNPNPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNPNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNNNNNNPPPPPPPPPPNPPPPPPPPPPNPPPPPPPPPPPNPPPPPPPPPPPPPPNPPPPPPPPPPNPPPPPPNPPPPPPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/31.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/31.java
Current actions:
INSERT:
18:if(right!=null){
String joinString=NodeUtil.getStringValue(right);
boolean isSimpleString=true;
for(int i=0;i<joinString.length();i++){
char ch=joinString.charAt(i);
if(ch=='"'||ch=='\\'){
isSimpleString=false;
break;
}
}
if(isSimpleString){
int foldedSize=0;
for(Node elem : arrayNode.children()){
foldedSize+=elem.getString().length();
}
int joinStringLength=joinString.length();
foldedSize+=(arrayNode.getChildCount()-1)*joinStringLength;
foldedSize+="[].join()".length();
if(foldedSize>InlineCostEstimator.getCost(n)){
return n;
}
String joined=Joiner.on(joinString).join(arrayNode.getStrings());
Node replacement=Node.newString(joined);
n.getParent().replaceChild(n,replacement);
reportCodeChange();
return replacement;
}
}
TO:
17

Following are 1th generated patches:
Validating 44 patches...
Current actions:
INSERT:
23:if(ch=='"'||ch=='\\'){
isSimpleString=false;
break;
}
TO:
17

Following are 2th generated patches:
Validating 200 patches...
Current actions:
INSERT:
28:if(isSimpleString){
int foldedSize=0;
for(Node elem : arrayNode.children()){
foldedSize+=elem.getString().length();
}
int joinStringLength=joinString.length();
foldedSize+=(arrayNode.getChildCount()-1)*joinStringLength;
foldedSize+="[].join()".length();
if(foldedSize>InlineCostEstimator.getCost(n)){
return n;
}
String joined=Joiner.on(joinString).join(arrayNode.getStrings());
Node replacement=Node.newString(joined);
n.getParent().replaceChild(n,replacement);
reportCodeChange();
return replacement;
}
TO:
17

Following are 3th generated patches:
Validating 50 patches...
Current actions:
INSERT:
36:if(foldedSize>InlineCostEstimator.getCost(n)){
return n;
}
TO:
17

Following are 4th generated patches:
Validating 200 patches...
Current actions:
INSERT:
22:char ch=joinString.charAt(i);
TO:
17

INSERT:
36:if(foldedSize>InlineCostEstimator.getCost(n)){
return n;
}
TO:
17

INSERT:
43:return replacement;
TO:
17

Tested:9240 patches
Compile failed:8715 patches
Compilation rate:0.056818181818181816
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/32.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/32.java
Current actions:
INSERT:
22:if(value==null){
return n;
}
TO:
18

INSERT:
35:}

TO:
51

DELETE:
Original line: 63return n;

Following are 1th generated patches:
Validating 40 patches...
Current actions:
INSERT:
26:if(elem.getNext()!=null){
sb.append(joinString);
}
TO:
33

DELETE:
Original line: 30sb.append(joinString);

INSERT:
35:}

TO:
51

Following are 2th generated patches:
Validating 200 patches...
Current actions:
INSERT:
19:StringBuilder sb=new StringBuilder();
TO:
18

DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

INSERT:
20:for(Node elem : NodeUtil.findLhsNodesInNode(arrayNode)){
String value=NodeUtil.getArrayElementStringValue(elem);
if(value==null){
return n;
}
sb.append(value);
if(elem.getNext()!=null){
sb.append(joinString);
}
}
TO:
18

DELETE:
Original line: 23Node elem=arrayNode.getFirstChild();

DELETE:
Original line: 27sb=new StringBuilder();

DELETE:
Original line: 30sb.append(joinString);

INSERT:
32:parent.replaceChild(n,foldedStringNode);
TO:
51

INSERT:
35:}

TO:
51

DELETE:
Original line: 38arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));

DELETE:
Original line: 42arrayFoldedChildren.add(elem);

DELETE:
Original line: 45elem=elem.getNext();

DELETE:
Original line: 49foldedSize+=sb.length()+2;

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 59return emptyStringNode;

DELETE:
Original line: 70n.getParent().replaceChild(n,foldedStringNode);

DELETE:
Original line: 71reportCodeChange();

DELETE:
Original line: 75return n;

DELETE:
Original line: 80if(foldedSize>originalSize){
return n;
}

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

DELETE:
Original line: 87reportCodeChange();

DELETE:
Original line: 90return n;

Following are 3th generated patches:
Validating 200 patches...
Tested:9677 patches
Compile failed:9152 patches
Compilation rate:0.054252350935207194
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/33.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/33.java
Current actions:
INSERT:
23:if(prev!=null){
Node joined=NodeUtil.newStringNode(elem,"\""+joinString+NodeUtil.getArrayElementStringValue(prev)+"\"");
prev.getParent().replaceChild(prev,joined);
reportCodeChange();
return joined;
}
TO:
25

Following are 1th generated patches:
Validating 36 patches...
Current actions:
INSERT:
2:private Node tryFoldArrayJoin(Node n){
Node callTarget=n.getFirstChild();
if(callTarget==null||!NodeUtil.isGetProp(callTarget)){
return n;
}
Node right=callTarget.getNext();
if(right!=null){
if(!NodeUtil.isImmutableValue(right)){
return n;
}
}
Node arrayNode=callTarget.getFirstChild();
Node functionName=arrayNode.getNext();
if((arrayNode.getType()!=Token.ARRAYLIT)||!functionName.getString().equals("join")){
return n;
}
String joinString=(right==null)?",":NodeUtil.getStringValue(right);
Node prev=null;
Node elem=arrayNode.getFirstChild();
while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(prev!=null){
Node joined=NodeUtil.newStringNode(elem,"\""+joinString+NodeUtil.getArrayElementStringValue(prev)+"\"");
prev.getParent().replaceChild(prev,joined);
reportCodeChange();
return joined;
}
}
else{
prev=elem;
}
elem=elem.getNext();
}
return n;
}
TO:
1

DELETE:
Original line: 16return n;

DELETE:
Original line: 18String joinString=(right==null)?",":NodeUtil.getStringValue(right);

DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

DELETE:
Original line: 22Node prev=null;

INSERT:
23:if(prev!=null){
Node joined=NodeUtil.newStringNode(elem,"\""+joinString+NodeUtil.getArrayElementStringValue(prev)+"\"");
prev.getParent().replaceChild(prev,joined);
reportCodeChange();
return joined;
}
TO:
25

DELETE:
Original line: 23Node elem=arrayNode.getFirstChild();

DELETE:
Original line: 24while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}
else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}
prev=elem;
elem=elem.getNext();
}

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

DELETE:
Original line: 54switch (arrayFoldedChildren.size()){
case 0 :
Node emptyStringNode=Node.newString("");
n.getParent().replaceChild(n,emptyStringNode);
reportCodeChange();
return emptyStringNode;
case 1 :
Node foldedStringNode=arrayFoldedChildren.remove(0);
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}
n.getParent().replaceChild(n,foldedStringNode);
reportCodeChange();
return foldedStringNode;
default :
if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}
int kJoinOverhead="[].join()".length();
foldedSize+=kJoinOverhead;
foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;
if(foldedSize>originalSize){
return n;
}
arrayNode.detachChildren();
for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}
reportCodeChange();
break;
}

DELETE:
Original line: 90return n;

Following are 2th generated patches:
Validating 43 patches...
Current actions:
INSERT:
2:private Node tryFoldArrayJoin(Node n){
Node callTarget=n.getFirstChild();
if(callTarget==null||!NodeUtil.isGetProp(callTarget)){
return n;
}
Node right=callTarget.getNext();
if(right!=null){
if(!NodeUtil.isImmutableValue(right)){
return n;
}
}
Node arrayNode=callTarget.getFirstChild();
Node functionName=arrayNode.getNext();
if((arrayNode.getType()!=Token.ARRAYLIT)||!functionName.getString().equals("join")){
return n;
}
String joinString=(right==null)?",":NodeUtil.getStringValue(right);
Node prev=null;
Node elem=arrayNode.getFirstChild();
while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(prev!=null){
Node joined=NodeUtil.newStringNode(elem,"\""+joinString+NodeUtil.getArrayElementStringValue(prev)+"\"");
prev.getParent().replaceChild(prev,joined);
reportCodeChange();
return joined;
}
}
else{
prev=elem;
}
elem=elem.getNext();
}
return n;
}
TO:
1

DELETE:
Original line: 16return n;

DELETE:
Original line: 18String joinString=(right==null)?",":NodeUtil.getStringValue(right);

DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

DELETE:
Original line: 21int foldedSize=0;

DELETE:
Original line: 22Node prev=null;

INSERT:
23:if(prev!=null){
Node joined=NodeUtil.newStringNode(elem,"\""+joinString+NodeUtil.getArrayElementStringValue(prev)+"\"");
prev.getParent().replaceChild(prev,joined);
reportCodeChange();
return joined;
}
TO:
25

DELETE:
Original line: 23Node elem=arrayNode.getFirstChild();

DELETE:
Original line: 24while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}
else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}
prev=elem;
elem=elem.getNext();
}

INSERT:
30:else{
prev=elem;
}
TO:
33

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

DELETE:
Original line: 53int originalSize=InlineCostEstimator.getCost(n);

DELETE:
Original line: 55case 0 :

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 58reportCodeChange();

DELETE:
Original line: 59return emptyStringNode;

DELETE:
Original line: 60case 1 :

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

DELETE:
Original line: 65arrayNode.detachChildren();

DELETE:
Original line: 66if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}

DELETE:
Original line: 71reportCodeChange();

DELETE:
Original line: 72return foldedStringNode;

DELETE:
Original line: 73default :

DELETE:
Original line: 74if(arrayFoldedChildren.size()==arrayNode.getChildCount()){
return n;
}

DELETE:
Original line: 77int kJoinOverhead="[].join()".length();

DELETE:
Original line: 78foldedSize+=kJoinOverhead;

DELETE:
Original line: 79foldedSize+=(right!=null)?InlineCostEstimator.getCost(right):0;

DELETE:
Original line: 80if(foldedSize>originalSize){
return n;
}

DELETE:
Original line: 83arrayNode.detachChildren();

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

DELETE:
Original line: 90return n;

Following are 3th generated patches:
Validating 66 patches...
Current actions:
DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

DELETE:
Original line: 21int foldedSize=0;

INSERT:
23:if(prev!=null){
Node joined=NodeUtil.newStringNode(elem,"\""+joinString+NodeUtil.getArrayElementStringValue(prev)+"\"");
prev.getParent().replaceChild(prev,joined);
reportCodeChange();
return joined;
}
TO:
25

DELETE:
Original line: 27sb=new StringBuilder();

DELETE:
Original line: 30sb.append(joinString);

DELETE:
Original line: 32sb.append(NodeUtil.getArrayElementStringValue(elem));

DELETE:
Original line: 35if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}

DELETE:
Original line: 41foldedSize+=InlineCostEstimator.getCost(elem);

DELETE:
Original line: 42arrayFoldedChildren.add(elem);

DELETE:
Original line: 49foldedSize+=sb.length()+2;

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 60case 1 :

DELETE:
Original line: 62if(foldedSize>originalSize){
return n;
}

DELETE:
Original line: 65arrayNode.detachChildren();

DELETE:
Original line: 66if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}

DELETE:
Original line: 70n.getParent().replaceChild(n,foldedStringNode);

DELETE:
Original line: 71reportCodeChange();

DELETE:
Original line: 72return foldedStringNode;

DELETE:
Original line: 73default :

DELETE:
Original line: 75return n;

DELETE:
Original line: 77int kJoinOverhead="[].join()".length();

DELETE:
Original line: 81return n;

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

DELETE:
Original line: 88break;

Following are 4th generated patches:
Validating 60 patches...
Current actions:
INSERT:
2:private Node tryFoldArrayJoin(Node n){
Node callTarget=n.getFirstChild();
if(callTarget==null||!NodeUtil.isGetProp(callTarget)){
return n;
}
Node right=callTarget.getNext();
if(right!=null){
if(!NodeUtil.isImmutableValue(right)){
return n;
}
}
Node arrayNode=callTarget.getFirstChild();
Node functionName=arrayNode.getNext();
if((arrayNode.getType()!=Token.ARRAYLIT)||!functionName.getString().equals("join")){
return n;
}
String joinString=(right==null)?",":NodeUtil.getStringValue(right);
Node prev=null;
Node elem=arrayNode.getFirstChild();
while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(prev!=null){
Node joined=NodeUtil.newStringNode(elem,"\""+joinString+NodeUtil.getArrayElementStringValue(prev)+"\"");
prev.getParent().replaceChild(prev,joined);
reportCodeChange();
return joined;
}
}
else{
prev=elem;
}
elem=elem.getNext();
}
return n;
}
TO:
1

DELETE:
Original line: 16return n;

DELETE:
Original line: 18String joinString=(right==null)?",":NodeUtil.getStringValue(right);

DELETE:
Original line: 19List<Node> arrayFoldedChildren=Lists.newLinkedList();

DELETE:
Original line: 20StringBuilder sb=null;

DELETE:
Original line: 22Node prev=null;

DELETE:
Original line: 23Node elem=arrayNode.getFirstChild();

DELETE:
Original line: 24while(elem!=null){
if(NodeUtil.isImmutableValue(elem)||elem.getType()==Token.EMPTY){
if(sb==null){
sb=new StringBuilder();
}
else{
sb.append(joinString);
}
sb.append(NodeUtil.getArrayElementStringValue(elem));
}
else{
if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
sb=null;
}
foldedSize+=InlineCostEstimator.getCost(elem);
arrayFoldedChildren.add(elem);
}
prev=elem;
elem=elem.getNext();
}

INSERT:
24:Node joined=NodeUtil.newStringNode(elem,"\""+joinString+NodeUtil.getArrayElementStringValue(prev)+"\"");
TO:
25

INSERT:
25:prev.getParent().replaceChild(prev,joined);
TO:
25

INSERT:
27:return joined;
TO:
25

INSERT:
30:else{
prev=elem;
}
TO:
33

DELETE:
Original line: 47if(sb!=null){
Preconditions.checkNotNull(prev);
foldedSize+=sb.length()+2;
arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));
}

DELETE:
Original line: 52foldedSize+=arrayFoldedChildren.size()-1;

DELETE:
Original line: 56Node emptyStringNode=Node.newString("");

DELETE:
Original line: 57n.getParent().replaceChild(n,emptyStringNode);

DELETE:
Original line: 59return emptyStringNode;

DELETE:
Original line: 61Node foldedStringNode=arrayFoldedChildren.remove(0);

DELETE:
Original line: 63return n;

DELETE:
Original line: 65arrayNode.detachChildren();

DELETE:
Original line: 66if(foldedStringNode.getType()!=Token.STRING){
Node replacement=new Node(Token.ADD,Node.newString("").copyInformationFrom(n),foldedStringNode);
foldedStringNode=replacement;
}

DELETE:
Original line: 70n.getParent().replaceChild(n,foldedStringNode);

DELETE:
Original line: 72return foldedStringNode;

DELETE:
Original line: 75return n;

DELETE:
Original line: 78foldedSize+=kJoinOverhead;

DELETE:
Original line: 81return n;

DELETE:
Original line: 83arrayNode.detachChildren();

DELETE:
Original line: 84for(Node node : arrayFoldedChildren){
arrayNode.addChildToBack(node);
}

DELETE:
Original line: 87reportCodeChange();

DELETE:
Original line: 88break;

DELETE:
Original line: 90return n;

Tested:9821 patches
Compile failed:9296 patches
Compilation rate:0.05345687811831789
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Current file:/data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/34.java
Patch Number: /data/PLM4APR/codex_out/200_patches_starcoder_all/closure_50/34.java
Current actions:
DELETE:
Original line: 20StringBuilder sb=null;

Following are 0th generated patches:
Validating 200 patches...
Current actions:
INSERT:
29:if(prev!=null){
foldedSize+=joinString.length()+2;
}
TO:
34

Following are 1th generated patches:
Validating 200 patches...
Current actions:
INSERT:
38:if(prev!=null){
foldedSize+=joinString.length()+2;
}
TO:
46

Following are 2th generated patches:
Validating 200 patches...
Current actions:
UPDATE
FROM:
32:sb.append(NodeUtil.getArrayElementStringValue(elem));
TO:
25:foldedSize+=NodeUtil.getArrayElementStringValue(elem).length()+2;

DELETE:
Original line: 26if(sb==null){
sb=new StringBuilder();
}

INSERT:
29:if(prev!=null){
foldedSize+=joinString.length()+2;
}
TO:
34

DELETE:
Original line: 30sb.append(joinString);

DELETE:
Original line: 38arrayFoldedChildren.add(Node.newString(sb.toString()).copyInformationFrom(prev));

INSERT:
38:if(prev!=null){
foldedSize+=joinString.length()+2;
}
TO:
46

Following are 3th generated patches:
Validating 200 patches...
Tested:10616 patches
Compile failed:9928 patches
Compilation rate:0.06480783722682742
NPPPPPPPPPPPPPPPPPPPNPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPNPNPNPNNNPNNNNPPPPPNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPPPPPPPPPNPNNNNNNNPNPNPPNNPNPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPPNNNNNNNNNNNNPNNNNNNNNNNNNNNPNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNPPNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNNNNNNNNNPNNNNNNNPNNNNPNPPNNNNNNNNNNNNNNNNNNNNNPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNPNNNNNNNNNPNNNNNNNNNNNNNNNNNPNNNNNNNNNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNPNPNNNPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNPNNPNNNNNNNNNNPNNNPNNPNNPNNNNNNNNNNNNNNNNNNNPPPNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
Finish : closure-50 > patch : 0 | Start : Fri Apr 12 02:21:58 HKT 2024 | End : 2024.04.12 AD at 02:45:34 HKT
